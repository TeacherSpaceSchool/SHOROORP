(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{387:function(e,t,n){"use strict";n.r(t),n.d(t,"datePicker",function(){return k});var a=n(7),i=n.n(a),o=n(13),r=n(391),c=n(0),u=n.n(c),s=n(2),l=n.n(s),g=n(6),d=n(55),f=n(31),p=n(72),m=n(418),b=n(40),h=n.n(b),v=n(93),w=n(535),O=n.n(w),y=n(95),S=n(534),j=n(442),x=n.n(j),E=n(39),k=u.a.createRef(),R=void 0===v.b||v.b.current.offsetWidth>800?20:10,P=void 0===v.b||v.b.current.offsetWidth>800?500:240,C=u.a.memo(function(e){var t=e.classes,n=e.mini_dialogActions,a=n.showSelectRegion,s=n.showSelectPoint,l=e.tableActions,g=l.setSelectedRegionGeo,d=l.setSelectedPointGeo,f=e.snackbarActions.showSnackBar,m=e.table,b=m.regionGeo,w=m.pointGeo,j=e.user.status,E=e.app.profile,k=Object(c.useState)(new Date),R=Object(r.a)(k,2),P=R[0],C=R[1],N=Object(c.useState)([]),T=Object(r.a)(N,2),A=T[0],D=T[1];Object(c.useEffect)(function(){Object(o.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0===w.guid.length||0===b.guid.length){e.next=7;break}return e.next=3,p.getDataSimple({name:"\u0413\u0435\u043e\u043b\u043e\u043a\u0430\u0446\u0438\u044f",data:{date:JSON.stringify(P).split("T")[0],guidRegion:b.guid,guidPoint:w.guid}});case 3:0===(t=e.sent).length?D([{point:w.name,geo:"42.8700000, 74.5900000",region:b.name,guidPoint:w.guid,guidRegion:b.guid,date:JSON.stringify(P).split("T")[0]}]):D(t),e.next=12;break;case 7:return e.t0=D,e.next=10,p.getDataSimple({name:"\u0413\u0435\u043e\u043b\u043e\u043a\u0430\u0446\u0438\u044f",data:{date:JSON.stringify(P).split("T")[0],guidRegion:b.guid,guidPoint:w.guid}});case 10:e.t1=e.sent,(0,e.t0)(e.t1);case 12:case"end":return e.stop()}},e,this)}))()},[w,b,P]),Object(c.useEffect)(function(){Object(o.a)(i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:"active"===j.status&&["admin","\u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0442\u043e\u0440","\u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0442\u043e\u0440"].includes(j.role)||e.history.push("/"),void 0!==j.role&&"admin"!==j.role&&(g({name:E.region,guid:E.guidRegion}),"\u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0442\u043e\u0440"!==j.role&&d({name:E.point,guid:E.guidPoint}));case 2:case"end":return t.stop()}},t,this)}))()},[]);var J=Object(c.useState)(600),G=Object(r.a)(J,2),W=G[0],z=G[1];Object(c.useEffect)(function(){Object(o.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:z(v.b.current.offsetWidth>1e3?[1e3,500]:[v.b.current.offsetWidth,300]);case 1:case"end":return e.stop()}},e,this)}))()},[]);var B=function(e){var t=e.get("target").geometry.getCoordinates();F(t[0]+", "+t[1])},F=function(){var e=Object(o.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=D,e.next=3,p.getDataSimple({name:"\u0413\u0435\u043e\u043b\u043e\u043a\u0430\u0446\u0438\u044f\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",data:{point:w.name,geo:t,region:b.name,date:JSON.stringify(P).split("T")[0],guidRegion:b.guid,guidPoint:w.guid}});case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}();return u.a.createElement(S.c,null,u.a.createElement("center",null,u.a.createElement("br",null),u.a.createElement("h1",null,"\u0413\u0435\u043e\u043b\u043e\u043a\u0430\u0446\u0438\u044f"),u.a.createElement("br",null),u.a.createElement(y.a,{views:["year","month","day"],label:"\u0414\u0430\u0442\u0430",className:t.textField,value:P,onChange:C}),u.a.createElement("br",null),u.a.createElement(h.a,{variant:"outlined",onClick:function(){"admin"===j.role&&a()},className:t.button},b.name),u.a.createElement(h.a,{variant:"outlined",onClick:function(){["admin","\u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0442\u043e\u0440"].includes(j.role)&&s()},className:t.button},w.name),u.a.createElement("br",null),u.a.createElement(S.a,{height:W[1],width:W[0],defaultState:{center:[42.87,74.59],zoom:12}},void 0!=A&&A.length>0?A.map(function(e,t){return u.a.createElement(S.b,{onDragEnd:B,key:t,options:{draggable:0!==w.guid.length&&0!==w.guid.length,iconColor:"#252850"},properties:{iconCaption:e.point},geometry:e.geo.split(", ")})}):null)),0!==w.guid.length&&0!==w.guid.length?u.a.createElement(O.a,{color:"primary","aria-label":"\u041d\u0430\u0439\u0442\u0438 \u0433\u0435\u043e\u043b\u043e\u043a\u0430\u0446\u0438\u044e",className:t.fab,onClick:function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){F(e.coords.latitude+", "+e.coords.longitude)}):f("\u0413\u0435\u043e\u043b\u043e\u043a\u0430\u0446\u0438\u044f \u043d\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442\u0441\u044f")}},u.a.createElement(x.a,null)):null)});Event.propTypes={classes:l.a.object.isRequired},t.default=Object(g.withStyles)(function(e){return{fab:{position:"fixed",bottom:R,right:R},fab2:{position:"fixed",bottom:R+76,right:R},button:{width:"200px",margin:e.spacing.unit},textFieldDate:{marginLeft:e.spacing.unit,marginRight:e.spacing.unit,width:P/2},heading:{fontSize:e.typography.pxToRem(15),flexBasis:"33.33%",flexShrink:0},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary}}})(Object(d.b)(function(e){return{table:e.table,user:e.user,app:e.app}},function(e){return{tableActions:Object(f.b)(p,e),snackbarActions:Object(f.b)(E,e),mini_dialogActions:Object(f.b)(m,e)}})(C))}}]);
//# sourceMappingURL=21.0a2c5fc8.chunk.js.map